/*
 *  Copyright (c) 2012 Daisuke Okanohara
 *
 *   Redistribution and use in source and binary forms, with or without
 *   modification, are permitted provided that the following conditions
 *   are met:
 *
 *   1. Redistributions of source code must retain the above Copyright
 *      notice, this list of conditions and the following disclaimer.
 *
 *   2. Redistributions in binary form must reproduce the above Copyright
 *      notice, this list of conditions and the following disclaimer in the
 *      documentation and/or other materials provided with the distribution.
 *
 *   3. Neither the name of the authors nor the names of its contributors
 *      may be used to endorse or promote products derived from this
 *      software without specific prior written permission.
 */

#include <am/succinct/rsdic/EnumCoder.hpp>
#include <am/succinct/utils.hpp>


NS_IZENELIB_AM_BEGIN

namespace succinct
{
namespace rsdic
{

uint64_t EnumCoder::Encode(uint64_t val, size_t rank_sb)
{
    if (rank_sb == 0 || rank_sb == kBlockSize) return 0;

    rank_sb = rank_sb > 32 ? (val = ~val, kBlockSize - rank_sb) : rank_sb;

    uint64_t code = 0;
    for (size_t i = 0; i < kBlockSize; ++i)
    {
        if (val >> i & 1LLU)
        {
            code += kCombinationTable64_[rank_sb][kBlockSize - i - 1];
            --rank_sb;
        }
    }

    return code;
}

uint64_t EnumCoder::Decode(uint64_t code, size_t rank_sb)
{
    if (rank_sb == 0) return 0;
    else if (rank_sb == kBlockSize) return (uint64_t)-1;

    size_t orig_rank_sb = rank_sb;
    rank_sb = rank_sb > 32 ? kBlockSize - rank_sb : rank_sb;

    uint64_t val = 0;
    for (size_t i = 0; i < kBlockSize; ++i)
    {
        uint64_t zero_case_num = kCombinationTable64_[rank_sb][kBlockSize - i - 1];
        if (code >= zero_case_num)
        {
            val |= 1LLU << i;
            code -= zero_case_num;
            if (--rank_sb == 0) break;
        }
    }

    return orig_rank_sb <= 32 ? val : ~val;
}

bool EnumCoder::GetBit(uint64_t code, size_t rank_sb, size_t pos)
{
    if (rank_sb == 0) return false;
    else if (rank_sb == kBlockSize) return true;
    else if (Len(rank_sb) == kBlockSize) return code >> pos & 1LLU;

    size_t orig_rank_sb = rank_sb;
    rank_sb = rank_sb > 32 ? kBlockSize - rank_sb : rank_sb;

    for (size_t i = 0; i < pos; ++i)
    {
        uint64_t zero_case_num = kCombinationTable64_[rank_sb][kBlockSize - i - 1];
        if (code >= zero_case_num)
        {
            code -= zero_case_num;
            --rank_sb;
        }
    }

    return orig_rank_sb <= 32
        ? code >= kCombinationTable64_[rank_sb][kBlockSize - pos - 1]
        : code < kCombinationTable64_[rank_sb][kBlockSize - pos - 1];
}

bool EnumCoder::GetBit(uint64_t code, size_t rank_sb, size_t pos, size_t& rank)
{
    if (rank_sb == 0)
    {
        rank = 0;
        return false;
    }
    else if (rank_sb == kBlockSize)
    {
        rank = pos;
        return true;
    }
    else if (Len(rank_sb) == kBlockSize)
    {
        rank = SuccinctUtils::popcount(code & ((1LLU << pos) - 1));
        return code >> pos & 1LLU;
    }

    size_t orig_rank_sb = rank_sb;
    rank_sb = rank_sb > 32 ? kBlockSize - rank_sb : rank_sb;

    rank = rank_sb;
    for (size_t i = 0; i < pos; ++i)
    {
        uint64_t zero_case_num = kCombinationTable64_[rank_sb][kBlockSize - i - 1];
        if (code >= zero_case_num)
        {
            code -= zero_case_num;
            --rank_sb;
        }
    }

    if (orig_rank_sb <= 32)
    {
        rank -= rank_sb;
        return code >= kCombinationTable64_[rank_sb][kBlockSize - pos - 1];
    }
    else
    {
        rank = pos - rank + rank_sb;
        return code < kCombinationTable64_[rank_sb][kBlockSize - pos - 1];
    }
}

size_t EnumCoder::Rank(uint64_t code, size_t rank_sb, size_t pos)
{
    if (rank_sb == 0) return 0;
    else if (rank_sb == kBlockSize) return pos;
    else if (Len(rank_sb) == kBlockSize) return SuccinctUtils::popcount(code & ((1LLU << pos) - 1));

    size_t orig_rank_sb = rank_sb;
    rank_sb = rank_sb > 32 ? kBlockSize - rank_sb : rank_sb;

    size_t cur_rank = rank_sb;
    for (size_t i = 0; i < pos; ++i)
    {
        uint64_t zero_case_num = kCombinationTable64_[cur_rank][kBlockSize - i - 1];
        if (code >= zero_case_num)
        {
            code -= zero_case_num;
            --cur_rank;
        }
    }

    return orig_rank_sb <= 32 ? rank_sb - cur_rank : pos - rank_sb + cur_rank;
}

size_t EnumCoder::Select0Enum_(uint64_t code, size_t rank_sb, size_t num)
{
    rank_sb = kBlockSize - rank_sb;
    for (size_t offset = 0; offset < kBlockSize; ++offset)
    {
        uint64_t zero_case_num = kCombinationTable64_[rank_sb][kBlockSize - offset - 1];
        if (code >= zero_case_num)
        {
            code -= zero_case_num;
            --rank_sb;
        }
        else
        {
            if (num == 0) return offset;
            --num;
        }
    }

    __assert(false);
    return 0;
}

size_t EnumCoder::Select1Enum_(uint64_t code, size_t rank_sb, size_t num)
{
    for (size_t offset = 0; offset < kBlockSize; ++offset)
    {
        uint64_t zero_case_num = kCombinationTable64_[rank_sb][kBlockSize - offset - 1];
        if (code >= zero_case_num)
        {
            if (num == 0) return offset;
            --num;
            code -= zero_case_num;
            --rank_sb;
        }
    }

    __assert(false);
    return 0;
}

size_t EnumCoder::Select0(uint64_t code, size_t rank_sb, size_t num)
{
    __assert(num < rank_sb);

    if (rank_sb == kBlockSize)
    {
        return num;
    }
    else if (Len(rank_sb) == kBlockSize)
    {
        return SuccinctUtils::selectBlock(~code, num);
    }
    else
    {
        return rank_sb > 32 ? Select0Enum_(code, rank_sb, num) : Select1Enum_(code, rank_sb, num);
    }
}

size_t EnumCoder::Select1(uint64_t code, size_t rank_sb, size_t num)
{
    __assert(num < rank_sb);

    if (rank_sb == kBlockSize)
    {
        return num;
    }
    else if (Len(rank_sb) == kBlockSize)
    {
        return SuccinctUtils::selectBlock(code, num);
    }
    else
    {
        return rank_sb <= 32 ? Select1Enum_(code, rank_sb, num) : Select0Enum_(code, rank_sb, num);
    }
}

size_t EnumCoder::Select(uint64_t code, size_t rank_sb, size_t num, bool bit)
{
    if (bit) return Select1(code, rank_sb, num);
    else return Select0(code, rank_sb, num);
}

const uint8_t EnumCoder::kEnumCodeLength_[65] =
{
    0,  6,  11, 16, 20, 23, 27, 30, 33, 35, 38, 40, 42, 44, 46, 64,
    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,
    64, 64, 46, 44, 42, 40, 38, 35, 33, 30, 27, 23, 20, 16, 11, 6,
    0
};

const uint64_t EnumCoder::kCombinationTable64_[33][64] =
{
    { 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU, 1LLU },
    { 0LLU, 1LLU, 2LLU, 3LLU, 4LLU, 5LLU, 6LLU, 7LLU, 8LLU, 9LLU, 10LLU, 11LLU, 12LLU, 13LLU, 14LLU, 15LLU, 16LLU, 17LLU, 18LLU, 19LLU, 20LLU, 21LLU, 22LLU, 23LLU, 24LLU, 25LLU, 26LLU, 27LLU, 28LLU, 29LLU, 30LLU, 31LLU, 32LLU, 33LLU, 34LLU, 35LLU, 36LLU, 37LLU, 38LLU, 39LLU, 40LLU, 41LLU, 42LLU, 43LLU, 44LLU, 45LLU, 46LLU, 47LLU, 48LLU, 49LLU, 50LLU, 51LLU, 52LLU, 53LLU, 54LLU, 55LLU, 56LLU, 57LLU, 58LLU, 59LLU, 60LLU, 61LLU, 62LLU, 63LLU },
    { 0LLU, 0LLU, 1LLU, 3LLU, 6LLU, 10LLU, 15LLU, 21LLU, 28LLU, 36LLU, 45LLU, 55LLU, 66LLU, 78LLU, 91LLU, 105LLU, 120LLU, 136LLU, 153LLU, 171LLU, 190LLU, 210LLU, 231LLU, 253LLU, 276LLU, 300LLU, 325LLU, 351LLU, 378LLU, 406LLU, 435LLU, 465LLU, 496LLU, 528LLU, 561LLU, 595LLU, 630LLU, 666LLU, 703LLU, 741LLU, 780LLU, 820LLU, 861LLU, 903LLU, 946LLU, 990LLU, 1035LLU, 1081LLU, 1128LLU, 1176LLU, 1225LLU, 1275LLU, 1326LLU, 1378LLU, 1431LLU, 1485LLU, 1540LLU, 1596LLU, 1653LLU, 1711LLU, 1770LLU, 1830LLU, 1891LLU, 1953LLU },
    { 0LLU, 0LLU, 0LLU, 1LLU, 4LLU, 10LLU, 20LLU, 35LLU, 56LLU, 84LLU, 120LLU, 165LLU, 220LLU, 286LLU, 364LLU, 455LLU, 560LLU, 680LLU, 816LLU, 969LLU, 1140LLU, 1330LLU, 1540LLU, 1771LLU, 2024LLU, 2300LLU, 2600LLU, 2925LLU, 3276LLU, 3654LLU, 4060LLU, 4495LLU, 4960LLU, 5456LLU, 5984LLU, 6545LLU, 7140LLU, 7770LLU, 8436LLU, 9139LLU, 9880LLU, 10660LLU, 11480LLU, 12341LLU, 13244LLU, 14190LLU, 15180LLU, 16215LLU, 17296LLU, 18424LLU, 19600LLU, 20825LLU, 22100LLU, 23426LLU, 24804LLU, 26235LLU, 27720LLU, 29260LLU, 30856LLU, 32509LLU, 34220LLU, 35990LLU, 37820LLU, 39711LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 5LLU, 15LLU, 35LLU, 70LLU, 126LLU, 210LLU, 330LLU, 495LLU, 715LLU, 1001LLU, 1365LLU, 1820LLU, 2380LLU, 3060LLU, 3876LLU, 4845LLU, 5985LLU, 7315LLU, 8855LLU, 10626LLU, 12650LLU, 14950LLU, 17550LLU, 20475LLU, 23751LLU, 27405LLU, 31465LLU, 35960LLU, 40920LLU, 46376LLU, 52360LLU, 58905LLU, 66045LLU, 73815LLU, 82251LLU, 91390LLU, 101270LLU, 111930LLU, 123410LLU, 135751LLU, 148995LLU, 163185LLU, 178365LLU, 194580LLU, 211876LLU, 230300LLU, 249900LLU, 270725LLU, 292825LLU, 316251LLU, 341055LLU, 367290LLU, 395010LLU, 424270LLU, 455126LLU, 487635LLU, 521855LLU, 557845LLU, 595665LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 6LLU, 21LLU, 56LLU, 126LLU, 252LLU, 462LLU, 792LLU, 1287LLU, 2002LLU, 3003LLU, 4368LLU, 6188LLU, 8568LLU, 11628LLU, 15504LLU, 20349LLU, 26334LLU, 33649LLU, 42504LLU, 53130LLU, 65780LLU, 80730LLU, 98280LLU, 118755LLU, 142506LLU, 169911LLU, 201376LLU, 237336LLU, 278256LLU, 324632LLU, 376992LLU, 435897LLU, 501942LLU, 575757LLU, 658008LLU, 749398LLU, 850668LLU, 962598LLU, 1086008LLU, 1221759LLU, 1370754LLU, 1533939LLU, 1712304LLU, 1906884LLU, 2118760LLU, 2349060LLU, 2598960LLU, 2869685LLU, 3162510LLU, 3478761LLU, 3819816LLU, 4187106LLU, 4582116LLU, 5006386LLU, 5461512LLU, 5949147LLU, 6471002LLU, 7028847LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 7LLU, 28LLU, 84LLU, 210LLU, 462LLU, 924LLU, 1716LLU, 3003LLU, 5005LLU, 8008LLU, 12376LLU, 18564LLU, 27132LLU, 38760LLU, 54264LLU, 74613LLU, 100947LLU, 134596LLU, 177100LLU, 230230LLU, 296010LLU, 376740LLU, 475020LLU, 593775LLU, 736281LLU, 906192LLU, 1107568LLU, 1344904LLU, 1623160LLU, 1947792LLU, 2324784LLU, 2760681LLU, 3262623LLU, 3838380LLU, 4496388LLU, 5245786LLU, 6096454LLU, 7059052LLU, 8145060LLU, 9366819LLU, 10737573LLU, 12271512LLU, 13983816LLU, 15890700LLU, 18009460LLU, 20358520LLU, 22957480LLU, 25827165LLU, 28989675LLU, 32468436LLU, 36288252LLU, 40475358LLU, 45057474LLU, 50063860LLU, 55525372LLU, 61474519LLU, 67945521LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 8LLU, 36LLU, 120LLU, 330LLU, 792LLU, 1716LLU, 3432LLU, 6435LLU, 11440LLU, 19448LLU, 31824LLU, 50388LLU, 77520LLU, 116280LLU, 170544LLU, 245157LLU, 346104LLU, 480700LLU, 657800LLU, 888030LLU, 1184040LLU, 1560780LLU, 2035800LLU, 2629575LLU, 3365856LLU, 4272048LLU, 5379616LLU, 6724520LLU, 8347680LLU, 10295472LLU, 12620256LLU, 15380937LLU, 18643560LLU, 22481940LLU, 26978328LLU, 32224114LLU, 38320568LLU, 45379620LLU, 53524680LLU, 62891499LLU, 73629072LLU, 85900584LLU, 99884400LLU, 115775100LLU, 133784560LLU, 154143080LLU, 177100560LLU, 202927725LLU, 231917400LLU, 264385836LLU, 300674088LLU, 341149446LLU, 386206920LLU, 436270780LLU, 491796152LLU, 553270671LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 9LLU, 45LLU, 165LLU, 495LLU, 1287LLU, 3003LLU, 6435LLU, 12870LLU, 24310LLU, 43758LLU, 75582LLU, 125970LLU, 203490LLU, 319770LLU, 490314LLU, 735471LLU, 1081575LLU, 1562275LLU, 2220075LLU, 3108105LLU, 4292145LLU, 5852925LLU, 7888725LLU, 10518300LLU, 13884156LLU, 18156204LLU, 23535820LLU, 30260340LLU, 38608020LLU, 48903492LLU, 61523748LLU, 76904685LLU, 95548245LLU, 118030185LLU, 145008513LLU, 177232627LLU, 215553195LLU, 260932815LLU, 314457495LLU, 377348994LLU, 450978066LLU, 536878650LLU, 636763050LLU, 752538150LLU, 886322710LLU, 1040465790LLU, 1217566350LLU, 1420494075LLU, 1652411475LLU, 1916797311LLU, 2217471399LLU, 2558620845LLU, 2944827765LLU, 3381098545LLU, 3872894697LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 10LLU, 55LLU, 220LLU, 715LLU, 2002LLU, 5005LLU, 11440LLU, 24310LLU, 48620LLU, 92378LLU, 167960LLU, 293930LLU, 497420LLU, 817190LLU, 1307504LLU, 2042975LLU, 3124550LLU, 4686825LLU, 6906900LLU, 10015005LLU, 14307150LLU, 20160075LLU, 28048800LLU, 38567100LLU, 52451256LLU, 70607460LLU, 94143280LLU, 124403620LLU, 163011640LLU, 211915132LLU, 273438880LLU, 350343565LLU, 445891810LLU, 563921995LLU, 708930508LLU, 886163135LLU, 1101716330LLU, 1362649145LLU, 1677106640LLU, 2054455634LLU, 2505433700LLU, 3042312350LLU, 3679075400LLU, 4431613550LLU, 5317936260LLU, 6358402050LLU, 7575968400LLU, 8996462475LLU, 10648873950LLU, 12565671261LLU, 14783142660LLU, 17341763505LLU, 20286591270LLU, 23667689815LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 11LLU, 66LLU, 286LLU, 1001LLU, 3003LLU, 8008LLU, 19448LLU, 43758LLU, 92378LLU, 184756LLU, 352716LLU, 646646LLU, 1144066LLU, 1961256LLU, 3268760LLU, 5311735LLU, 8436285LLU, 13123110LLU, 20030010LLU, 30045015LLU, 44352165LLU, 64512240LLU, 92561040LLU, 131128140LLU, 183579396LLU, 254186856LLU, 348330136LLU, 472733756LLU, 635745396LLU, 847660528LLU, 1121099408LLU, 1471442973LLU, 1917334783LLU, 2481256778LLU, 3190187286LLU, 4076350421LLU, 5178066751LLU, 6540715896LLU, 8217822536LLU, 10272278170LLU, 12777711870LLU, 15820024220LLU, 19499099620LLU, 23930713170LLU, 29248649430LLU, 35607051480LLU, 43183019880LLU, 52179482355LLU, 62828356305LLU, 75394027566LLU, 90177170226LLU, 107518933731LLU, 127805525001LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 12LLU, 78LLU, 364LLU, 1365LLU, 4368LLU, 12376LLU, 31824LLU, 75582LLU, 167960LLU, 352716LLU, 705432LLU, 1352078LLU, 2496144LLU, 4457400LLU, 7726160LLU, 13037895LLU, 21474180LLU, 34597290LLU, 54627300LLU, 84672315LLU, 129024480LLU, 193536720LLU, 286097760LLU, 417225900LLU, 600805296LLU, 854992152LLU, 1203322288LLU, 1676056044LLU, 2311801440LLU, 3159461968LLU, 4280561376LLU, 5752004349LLU, 7669339132LLU, 10150595910LLU, 13340783196LLU, 17417133617LLU, 22595200368LLU, 29135916264LLU, 37353738800LLU, 47626016970LLU, 60403728840LLU, 76223753060LLU, 95722852680LLU, 119653565850LLU, 148902215280LLU, 184509266760LLU, 227692286640LLU, 279871768995LLU, 342700125300LLU, 418094152866LLU, 508271323092LLU, 615790256823LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 13LLU, 91LLU, 455LLU, 1820LLU, 6188LLU, 18564LLU, 50388LLU, 125970LLU, 293930LLU, 646646LLU, 1352078LLU, 2704156LLU, 5200300LLU, 9657700LLU, 17383860LLU, 30421755LLU, 51895935LLU, 86493225LLU, 141120525LLU, 225792840LLU, 354817320LLU, 548354040LLU, 834451800LLU, 1251677700LLU, 1852482996LLU, 2707475148LLU, 3910797436LLU, 5586853480LLU, 7898654920LLU, 11058116888LLU, 15338678264LLU, 21090682613LLU, 28760021745LLU, 38910617655LLU, 52251400851LLU, 69668534468LLU, 92263734836LLU, 121399651100LLU, 158753389900LLU, 206379406870LLU, 266783135710LLU, 343006888770LLU, 438729741450LLU, 558383307300LLU, 707285522580LLU, 891794789340LLU, 1119487075980LLU, 1399358844975LLU, 1742058970275LLU, 2160153123141LLU, 2668424446233LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 14LLU, 105LLU, 560LLU, 2380LLU, 8568LLU, 27132LLU, 77520LLU, 203490LLU, 497420LLU, 1144066LLU, 2496144LLU, 5200300LLU, 10400600LLU, 20058300LLU, 37442160LLU, 67863915LLU, 119759850LLU, 206253075LLU, 347373600LLU, 573166440LLU, 927983760LLU, 1476337800LLU, 2310789600LLU, 3562467300LLU, 5414950296LLU, 8122425444LLU, 12033222880LLU, 17620076360LLU, 25518731280LLU, 36576848168LLU, 51915526432LLU, 73006209045LLU, 101766230790LLU, 140676848445LLU, 192928249296LLU, 262596783764LLU, 354860518600LLU, 476260169700LLU, 635013559600LLU, 841392966470LLU, 1108176102180LLU, 1451182990950LLU, 1889912732400LLU, 2448296039700LLU, 3155581562280LLU, 4047376351620LLU, 5166863427600LLU, 6566222272575LLU, 8308281242850LLU, 10468434365991LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 15LLU, 120LLU, 680LLU, 3060LLU, 11628LLU, 38760LLU, 116280LLU, 319770LLU, 817190LLU, 1961256LLU, 4457400LLU, 9657700LLU, 20058300LLU, 40116600LLU, 77558760LLU, 145422675LLU, 265182525LLU, 471435600LLU, 818809200LLU, 1391975640LLU, 2319959400LLU, 3796297200LLU, 6107086800LLU, 9669554100LLU, 15084504396LLU, 23206929840LLU, 35240152720LLU, 52860229080LLU, 78378960360LLU, 114955808528LLU, 166871334960LLU, 239877544005LLU, 341643774795LLU, 482320623240LLU, 675248872536LLU, 937845656300LLU, 1292706174900LLU, 1768966344600LLU, 2403979904200LLU, 3245372870670LLU, 4353548972850LLU, 5804731963800LLU, 7694644696200LLU, 10142940735900LLU, 13298522298180LLU, 17345898649800LLU, 22512762077400LLU, 29078984349975LLU, 37387265592825LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 16LLU, 136LLU, 816LLU, 3876LLU, 15504LLU, 54264LLU, 170544LLU, 490314LLU, 1307504LLU, 3268760LLU, 7726160LLU, 17383860LLU, 37442160LLU, 77558760LLU, 155117520LLU, 300540195LLU, 565722720LLU, 1037158320LLU, 1855967520LLU, 3247943160LLU, 5567902560LLU, 9364199760LLU, 15471286560LLU, 25140840660LLU, 40225345056LLU, 63432274896LLU, 98672427616LLU, 151532656696LLU, 229911617056LLU, 344867425584LLU, 511738760544LLU, 751616304549LLU, 1093260079344LLU, 1575580702584LLU, 2250829575120LLU, 3188675231420LLU, 4481381406320LLU, 6250347750920LLU, 8654327655120LLU, 11899700525790LLU, 16253249498640LLU, 22057981462440LLU, 29752626158640LLU, 39895566894540LLU, 53194089192720LLU, 70539987842520LLU, 93052749919920LLU, 122131734269895LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 17LLU, 153LLU, 969LLU, 4845LLU, 20349LLU, 74613LLU, 245157LLU, 735471LLU, 2042975LLU, 5311735LLU, 13037895LLU, 30421755LLU, 67863915LLU, 145422675LLU, 300540195LLU, 601080390LLU, 1166803110LLU, 2203961430LLU, 4059928950LLU, 7307872110LLU, 12875774670LLU, 22239974430LLU, 37711260990LLU, 62852101650LLU, 103077446706LLU, 166509721602LLU, 265182149218LLU, 416714805914LLU, 646626422970LLU, 991493848554LLU, 1503232609098LLU, 2254848913647LLU, 3348108992991LLU, 4923689695575LLU, 7174519270695LLU, 10363194502115LLU, 14844575908435LLU, 21094923659355LLU, 29749251314475LLU, 41648951840265LLU, 57902201338905LLU, 79960182801345LLU, 109712808959985LLU, 149608375854525LLU, 202802465047245LLU, 273342452889765LLU, 366395202809685LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 18LLU, 171LLU, 1140LLU, 5985LLU, 26334LLU, 100947LLU, 346104LLU, 1081575LLU, 3124550LLU, 8436285LLU, 21474180LLU, 51895935LLU, 119759850LLU, 265182525LLU, 565722720LLU, 1166803110LLU, 2333606220LLU, 4537567650LLU, 8597496600LLU, 15905368710LLU, 28781143380LLU, 51021117810LLU, 88732378800LLU, 151584480450LLU, 254661927156LLU, 421171648758LLU, 686353797976LLU, 1103068603890LLU, 1749695026860LLU, 2741188875414LLU, 4244421484512LLU, 6499270398159LLU, 9847379391150LLU, 14771069086725LLU, 21945588357420LLU, 32308782859535LLU, 47153358767970LLU, 68248282427325LLU, 97997533741800LLU, 139646485582065LLU, 197548686920970LLU, 277508869722315LLU, 387221678682300LLU, 536830054536825LLU, 739632519584070LLU, 1012974972473835LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 19LLU, 190LLU, 1330LLU, 7315LLU, 33649LLU, 134596LLU, 480700LLU, 1562275LLU, 4686825LLU, 13123110LLU, 34597290LLU, 86493225LLU, 206253075LLU, 471435600LLU, 1037158320LLU, 2203961430LLU, 4537567650LLU, 9075135300LLU, 17672631900LLU, 33578000610LLU, 62359143990LLU, 113380261800LLU, 202112640600LLU, 353697121050LLU, 608359048206LLU, 1029530696964LLU, 1715884494940LLU, 2818953098830LLU, 4568648125690LLU, 7309837001104LLU, 11554258485616LLU, 18053528883775LLU, 27900908274925LLU, 42671977361650LLU, 64617565719070LLU, 96926348578605LLU, 144079707346575LLU, 212327989773900LLU, 310325523515700LLU, 449972009097765LLU, 647520696018735LLU, 925029565741050LLU, 1312251244423350LLU, 1849081298960175LLU, 2588713818544245LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 20LLU, 210LLU, 1540LLU, 8855LLU, 42504LLU, 177100LLU, 657800LLU, 2220075LLU, 6906900LLU, 20030010LLU, 54627300LLU, 141120525LLU, 347373600LLU, 818809200LLU, 1855967520LLU, 4059928950LLU, 8597496600LLU, 17672631900LLU, 35345263800LLU, 68923264410LLU, 131282408400LLU, 244662670200LLU, 446775310800LLU, 800472431850LLU, 1408831480056LLU, 2438362177020LLU, 4154246671960LLU, 6973199770790LLU, 11541847896480LLU, 18851684897584LLU, 30405943383200LLU, 48459472266975LLU, 76360380541900LLU, 119032357903550LLU, 183649923622620LLU, 280576272201225LLU, 424655979547800LLU, 636983969321700LLU, 947309492837400LLU, 1397281501935165LLU, 2044802197953900LLU, 2969831763694950LLU, 4282083008118300LLU, 6131164307078475LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 21LLU, 231LLU, 1771LLU, 10626LLU, 53130LLU, 230230LLU, 888030LLU, 3108105LLU, 10015005LLU, 30045015LLU, 84672315LLU, 225792840LLU, 573166440LLU, 1391975640LLU, 3247943160LLU, 7307872110LLU, 15905368710LLU, 33578000610LLU, 68923264410LLU, 137846528820LLU, 269128937220LLU, 513791607420LLU, 960566918220LLU, 1761039350070LLU, 3169870830126LLU, 5608233007146LLU, 9762479679106LLU, 16735679449896LLU, 28277527346376LLU, 47129212243960LLU, 77535155627160LLU, 125994627894135LLU, 202355008436035LLU, 321387366339585LLU, 505037289962205LLU, 785613562163430LLU, 1210269541711230LLU, 1847253511032930LLU, 2794563003870330LLU, 4191844505805495LLU, 6236646703759395LLU, 9206478467454345LLU, 13488561475572645LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 22LLU, 253LLU, 2024LLU, 12650LLU, 65780LLU, 296010LLU, 1184040LLU, 4292145LLU, 14307150LLU, 44352165LLU, 129024480LLU, 354817320LLU, 927983760LLU, 2319959400LLU, 5567902560LLU, 12875774670LLU, 28781143380LLU, 62359143990LLU, 131282408400LLU, 269128937220LLU, 538257874440LLU, 1052049481860LLU, 2012616400080LLU, 3773655750150LLU, 6943526580276LLU, 12551759587422LLU, 22314239266528LLU, 39049918716424LLU, 67327446062800LLU, 114456658306760LLU, 191991813933920LLU, 317986441828055LLU, 520341450264090LLU, 841728816603675LLU, 1346766106565880LLU, 2132379668729310LLU, 3342649210440540LLU, 5189902721473470LLU, 7984465725343800LLU, 12176310231149295LLU, 18412956934908690LLU, 27619435402363035LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 23LLU, 276LLU, 2300LLU, 14950LLU, 80730LLU, 376740LLU, 1560780LLU, 5852925LLU, 20160075LLU, 64512240LLU, 193536720LLU, 548354040LLU, 1476337800LLU, 3796297200LLU, 9364199760LLU, 22239974430LLU, 51021117810LLU, 113380261800LLU, 244662670200LLU, 513791607420LLU, 1052049481860LLU, 2104098963720LLU, 4116715363800LLU, 7890371113950LLU, 14833897694226LLU, 27385657281648LLU, 49699896548176LLU, 88749815264600LLU, 156077261327400LLU, 270533919634160LLU, 462525733568080LLU, 780512175396135LLU, 1300853625660225LLU, 2142582442263900LLU, 3489348548829780LLU, 5621728217559090LLU, 8964377427999630LLU, 14154280149473100LLU, 22138745874816900LLU, 34315056105966195LLU, 52728013040874885LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 24LLU, 300LLU, 2600LLU, 17550LLU, 98280LLU, 475020LLU, 2035800LLU, 7888725LLU, 28048800LLU, 92561040LLU, 286097760LLU, 834451800LLU, 2310789600LLU, 6107086800LLU, 15471286560LLU, 37711260990LLU, 88732378800LLU, 202112640600LLU, 446775310800LLU, 960566918220LLU, 2012616400080LLU, 4116715363800LLU, 8233430727600LLU, 16123801841550LLU, 30957699535776LLU, 58343356817424LLU, 108043253365600LLU, 196793068630200LLU, 352870329957600LLU, 623404249591760LLU, 1085929983159840LLU, 1866442158555975LLU, 3167295784216200LLU, 5309878226480100LLU, 8799226775309880LLU, 14420954992868970LLU, 23385332420868600LLU, 37539612570341700LLU, 59678358445158600LLU, 93993414551124795LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 25LLU, 325LLU, 2925LLU, 20475LLU, 118755LLU, 593775LLU, 2629575LLU, 10518300LLU, 38567100LLU, 131128140LLU, 417225900LLU, 1251677700LLU, 3562467300LLU, 9669554100LLU, 25140840660LLU, 62852101650LLU, 151584480450LLU, 353697121050LLU, 800472431850LLU, 1761039350070LLU, 3773655750150LLU, 7890371113950LLU, 16123801841550LLU, 32247603683100LLU, 63205303218876LLU, 121548660036300LLU, 229591913401900LLU, 426384982032100LLU, 779255311989700LLU, 1402659561581460LLU, 2488589544741300LLU, 4355031703297275LLU, 7522327487513475LLU, 12832205713993575LLU, 21631432489303455LLU, 36052387482172425LLU, 59437719903041025LLU, 96977332473382725LLU, 156655690918541325LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 26LLU, 351LLU, 3276LLU, 23751LLU, 142506LLU, 736281LLU, 3365856LLU, 13884156LLU, 52451256LLU, 183579396LLU, 600805296LLU, 1852482996LLU, 5414950296LLU, 15084504396LLU, 40225345056LLU, 103077446706LLU, 254661927156LLU, 608359048206LLU, 1408831480056LLU, 3169870830126LLU, 6943526580276LLU, 14833897694226LLU, 30957699535776LLU, 63205303218876LLU, 126410606437752LLU, 247959266474052LLU, 477551179875952LLU, 903936161908052LLU, 1683191473897752LLU, 3085851035479212LLU, 5574440580220512LLU, 9929472283517787LLU, 17451799771031262LLU, 30284005485024837LLU, 51915437974328292LLU, 87967825456500717LLU, 147405545359541742LLU, 244382877832924467LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 27LLU, 378LLU, 3654LLU, 27405LLU, 169911LLU, 906192LLU, 4272048LLU, 18156204LLU, 70607460LLU, 254186856LLU, 854992152LLU, 2707475148LLU, 8122425444LLU, 23206929840LLU, 63432274896LLU, 166509721602LLU, 421171648758LLU, 1029530696964LLU, 2438362177020LLU, 5608233007146LLU, 12551759587422LLU, 27385657281648LLU, 58343356817424LLU, 121548660036300LLU, 247959266474052LLU, 495918532948104LLU, 973469712824056LLU, 1877405874732108LLU, 3560597348629860LLU, 6646448384109072LLU, 12220888964329584LLU, 22150361247847371LLU, 39602161018878633LLU, 69886166503903470LLU, 121801604478231762LLU, 209769429934732479LLU, 357174975294274221LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 28LLU, 406LLU, 4060LLU, 31465LLU, 201376LLU, 1107568LLU, 5379616LLU, 23535820LLU, 94143280LLU, 348330136LLU, 1203322288LLU, 3910797436LLU, 12033222880LLU, 35240152720LLU, 98672427616LLU, 265182149218LLU, 686353797976LLU, 1715884494940LLU, 4154246671960LLU, 9762479679106LLU, 22314239266528LLU, 49699896548176LLU, 108043253365600LLU, 229591913401900LLU, 477551179875952LLU, 973469712824056LLU, 1946939425648112LLU, 3824345300380220LLU, 7384942649010080LLU, 14031391033119152LLU, 26252279997448736LLU, 48402641245296107LLU, 88004802264174740LLU, 157890968768078210LLU, 279692573246309972LLU, 489462003181042451LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 29LLU, 435LLU, 4495LLU, 35960LLU, 237336LLU, 1344904LLU, 6724520LLU, 30260340LLU, 124403620LLU, 472733756LLU, 1676056044LLU, 5586853480LLU, 17620076360LLU, 52860229080LLU, 151532656696LLU, 416714805914LLU, 1103068603890LLU, 2818953098830LLU, 6973199770790LLU, 16735679449896LLU, 39049918716424LLU, 88749815264600LLU, 196793068630200LLU, 426384982032100LLU, 903936161908052LLU, 1877405874732108LLU, 3824345300380220LLU, 7648690600760440LLU, 15033633249770520LLU, 29065024282889672LLU, 55317304280338408LLU, 103719945525634515LLU, 191724747789809255LLU, 349615716557887465LLU, 629308289804197437LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 30LLU, 465LLU, 4960LLU, 40920LLU, 278256LLU, 1623160LLU, 8347680LLU, 38608020LLU, 163011640LLU, 635745396LLU, 2311801440LLU, 7898654920LLU, 25518731280LLU, 78378960360LLU, 229911617056LLU, 646626422970LLU, 1749695026860LLU, 4568648125690LLU, 11541847896480LLU, 28277527346376LLU, 67327446062800LLU, 156077261327400LLU, 352870329957600LLU, 779255311989700LLU, 1683191473897752LLU, 3560597348629860LLU, 7384942649010080LLU, 15033633249770520LLU, 30067266499541040LLU, 59132290782430712LLU, 114449595062769120LLU, 218169540588403635LLU, 409894288378212890LLU, 759510004936100355LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 31LLU, 496LLU, 5456LLU, 46376LLU, 324632LLU, 1947792LLU, 10295472LLU, 48903492LLU, 211915132LLU, 847660528LLU, 3159461968LLU, 11058116888LLU, 36576848168LLU, 114955808528LLU, 344867425584LLU, 991493848554LLU, 2741188875414LLU, 7309837001104LLU, 18851684897584LLU, 47129212243960LLU, 114456658306760LLU, 270533919634160LLU, 623404249591760LLU, 1402659561581460LLU, 3085851035479212LLU, 6646448384109072LLU, 14031391033119152LLU, 29065024282889672LLU, 59132290782430712LLU, 118264581564861424LLU, 232714176627630544LLU, 450883717216034179LLU, 860778005594247069LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 32LLU, 528LLU, 5984LLU, 52360LLU, 376992LLU, 2324784LLU, 12620256LLU, 61523748LLU, 273438880LLU, 1121099408LLU, 4280561376LLU, 15338678264LLU, 51915526432LLU, 166871334960LLU, 511738760544LLU, 1503232609098LLU, 4244421484512LLU, 11554258485616LLU, 30405943383200LLU, 77535155627160LLU, 191991813933920LLU, 462525733568080LLU, 1085929983159840LLU, 2488589544741300LLU, 5574440580220512LLU, 12220888964329584LLU, 26252279997448736LLU, 55317304280338408LLU, 114449595062769120LLU, 232714176627630544LLU, 465428353255261088LLU, 916312070471295267LLU },
    { 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 0LLU, 1LLU, 33LLU, 561LLU, 6545LLU, 58905LLU, 435897LLU, 2760681LLU, 15380937LLU, 76904685LLU, 350343565LLU, 1471442973LLU, 5752004349LLU, 21090682613LLU, 73006209045LLU, 239877544005LLU, 751616304549LLU, 2254848913647LLU, 6499270398159LLU, 18053528883775LLU, 48459472266975LLU, 125994627894135LLU, 317986441828055LLU, 780512175396135LLU, 1866442158555975LLU, 4355031703297275LLU, 9929472283517787LLU, 22150361247847371LLU, 48402641245296107LLU, 103719945525634515LLU, 218169540588403635LLU, 450883717216034179LLU, 916312070471295267LLU }
};

}
}

NS_IZENELIB_AM_END
